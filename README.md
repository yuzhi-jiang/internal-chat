# å‘ä¸ªä¸œè¥¿
ä¸€ä¸ªå±€åŸŸç½‘æ–‡å­—/æ–‡ä»¶P2Pä¼ è¾“å·¥å…·
> é¡¹ç›®ä¸­ä»…åœ¨çº¿ç”¨æˆ·åˆ—è¡¨å’ŒWebRTCä¿¡ä»¤è¿«ä¸å¾—å·²éœ€è¦ä¸€ä¸ªè½»é‡åŒ–çš„æœåŠ¡ï¼Œå…¶ä»–æ•°æ®ä¼ è¾“éƒ½é‡‡ç”¨äº†åŸºäºWebRTCçš„ç‚¹å¯¹ç‚¹ä¼ è¾“ï¼Œä¸ç»è¿‡ä¸­é—´æœåŠ¡å™¨ï¼Œæ‰€ä»¥å±€åŸŸç½‘å†…äº’ä¼ ä¸€äº›æ–‡å­—/æ–‡ä»¶éƒ½æ¯”è¾ƒå¿«ã€‚

demoæ¼”ç¤ºï¼šhttps://fagedongxi.com

## ä¼˜ç‚¹
æ— éœ€å®‰è£…ä»»ä½•è½¯ä»¶ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œæ— éœ€ç™»å½•ç›´æ¥ä¼ è¾“ã€‚

## ç¼ºç‚¹
æ¥æ”¶å¤§æ–‡ä»¶æ¯”è¾ƒåƒå†…å­˜ï¼ˆå•æ–‡ä»¶å‡ ç™¾å…†ä¸€èˆ¬æ²¡é—®é¢˜ï¼‰

## åœºæ™¯ï¼š
æ¯”å¦‚æ–°è£…çš„winç³»ç»Ÿéœ€è¦ä»macç³»ç»Ÿä¼ ä¸€äº›éœ€è¦ğŸªœæ‰èƒ½ä¸‹è½½çš„è½¯ä»¶æˆ–è€…æœåˆ°çš„ä¸€äº›ä¸œè¥¿

## æœåŠ¡ç«¯éƒ¨ç½²ï¼ˆä»…éƒ¨ç½²æœåŠ¡ç«¯ä¸è¡Œï¼Œä¸€å®šçœ‹åˆ°æœ€åçš„â€œç½‘é¡µéƒ¨ç½²â€ï¼‰ï¼š
éƒ¨ç½²ä»‹ç»ï¼šhttps://v.douyin.com/iUWewPmf/

### æºç æ–¹å¼
1. å®‰è£…nodejsï¼Œnodeç‰ˆæœ¬æ²¡æœ‰æµ‹è¯•ï¼Œæˆ‘ç”¨çš„æ˜¯ `16.20.2`
2. ä¸‹è½½æºç ï¼ˆæœåŠ¡ç«¯ä»…éœ€è¦`server`ç›®å½•ï¼‰
3. è¿›å…¥ `server` ç›®å½•ï¼Œè¿è¡Œ `npm install`
4. è¿è¡Œ `npm run start [port]` ï¼Œä¾‹å¦‚ `npm run start 8081`

### äºŒè¿›åˆ¶æ–¹å¼
* ä¸‹è½½å¯¹åº”å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œå³å¯ï¼ˆæœåŠ¡ç«¯ï¼‰
* é»˜è®¤ç›‘å¬ `8081` ç«¯å£ï¼Œå¯é€šè¿‡å‚æ•°æŒ‡å®šç«¯å£ï¼Œä¾‹å¦‚ `./internal-chat-linux 8082`
* å¦‚æœä½ ç”¨windowsï¼Œå¯å‚è€ƒ https://v.douyin.com/CeiJahpLD/ æ³¨å†ŒæˆæœåŠ¡

### æœåŠ¡ç«¯nginxåå‘ä»£ç†é…ç½®å‚è€ƒï¼ˆå¯é€‰ï¼‰
> æœåŠ¡ç«¯ç”¨åå‘ä»£ç†çš„å¥½å¤„ï¼šå¯ä»¥ç›´æ¥ç”¨certbotç”³è¯·httpsè¯ä¹¦ï¼Œç„¶åç›´æ¥ç”¨wssåè®®ã€‚
> å¦‚æœé‡‡ç”¨ä¸‹æ–¹çš„é…ç½®åå‘ä»£ç†ï¼Œæ³¨æ„åœ¨å®¢æˆ·ç«¯é…ç½®`wsUrl`å˜é‡çš„æ—¶å€™ï¼Œéœ€è¦åŠ  `/ws`ï¼Œå¦åˆ™ä¸ç”¨
```
  location /ws/ {
    proxy_pass http://localhost:8081/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }
```

## ç½‘é¡µéƒ¨ç½²ï¼š
1. ä¸‹è½½æºç å¹¶ä¿®æ”¹`www/index.js`ç¬¬ä¸€è¡Œä»£ç `wsUrl`å˜é‡ï¼ˆå¦‚æœæœåŠ¡ç«¯é…ç½®äº†åå‘ä»£ç†ï¼Œè¿™é‡Œè·¯å¾„æœ€åè¦åŠ `/ws`ï¼Œå¦åˆ™ä¸ç”¨ï¼‰
2. ç›´æ¥å°†`www`ç”¨nginxéƒ¨ç½²æˆä¸€ä¸ªé™æ€ç½‘ç«™å³å¯ï¼Œå…·ä½“é…ç½®å‚è€ƒ `nginxvhost.conf`ã€‚å¦‚æœä½ æ²¡æœ‰åŸŸåï¼Œå°† `server_name` å†™æˆ `_` å³å¯ï¼ˆå±äºnginxåŸºç¡€çŸ¥è¯†ï¼‰
3. è®¿é—® `http://your.domain.com/` å³å¯

